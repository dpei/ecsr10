% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/comorbidity.R
\name{comorbidity}
\alias{comorbidity}
\title{Apply comorbidity analysis to patient diagnosis data}
\usage{
comorbidity(
  patient_data,
  dx_cols,
  poa_cols = NULL,
  year_col = "year",
  quarter_col = "quarter",
  comfmt = NULL,
  poa_exempt = NULL,
  use_poa = TRUE,
  wildcard_mode = "wildcard"
)
}
\arguments{
\item{patient_data}{Data frame containing patient diagnosis data}

\item{dx_cols}{Character vector of column names containing diagnosis codes}

\item{poa_cols}{Character vector of column names containing POA indicators (optional)}

\item{year_col}{Character, name of column containing year information (default "year")}

\item{quarter_col}{Character, name of column containing quarter information (default "quarter")}

\item{comfmt}{Data frame with comorbidity format containing "target" and "pattern" columns.
If NULL (default), uses the built-in comfmt_lookup data.}

\item{poa_exempt}{Named list of POA exempt codes by version. If NULL (default),
uses the built-in poaxmpt_codes_long data when use_poa is TRUE.}

\item{use_poa}{Logical, whether to apply POA logic (default TRUE)}

\item{wildcard_mode}{Character, pattern matching mode ("wildcard" or "regex")}
}
\value{
Data frame with original patient diagnosis data plus 38 CMR comorbidity flags
}
\description{
This function processes patient diagnosis data to identify comorbidities based on ICD-10-CM 
diagnosis codes using the Elixhauser Comorbidity Software Refined (CMR) methodology.
It handles Present on Admission (POA) logic, combination codes, and hierarchical exclusions.
}
\details{
The function identifies 38 comorbidity categories:
\itemize{
  \item CMR_AIDS: HIV/AIDS
  \item CMR_ALCOHOL: Alcohol abuse
  \item CMR_ANEMDEF: Deficiency anemia
  \item CMR_AUTOIMMUNE: Autoimmune conditions
  \item CMR_BLDLOSS: Blood loss
  \item CMR_CANCER_LEUK: Leukemia
  \item CMR_CANCER_LYMPH: Lymphoma
  \item CMR_CANCER_METS: Metastatic cancer
  \item CMR_CANCER_NSITU: Non-situ cancer
  \item CMR_CANCER_SOLID: Solid tumor cancer
  \item CMR_CBVD: Cerebrovascular disease
  \item CMR_HF: Heart failure
  \item CMR_COAG: Coagulopathy
  \item CMR_DEMENTIA: Dementia
  \item CMR_DEPRESS: Depression
  \item CMR_DIAB_CX: Diabetes with complications
  \item CMR_DIAB_UNCX: Diabetes without complications
  \item CMR_DRUG_ABUSE: Drug abuse
  \item CMR_HTN_CX: Hypertension with complications
  \item CMR_HTN_UNCX: Hypertension without complications
  \item CMR_LIVER_MLD: Mild liver disease
  \item CMR_LIVER_SEV: Severe liver disease
  \item CMR_LUNG_CHRONIC: Chronic lung disease
  \item CMR_NEURO_MOVT: Neurological movement disorders
  \item CMR_NEURO_OTH: Other neurological disorders
  \item CMR_NEURO_SEIZ: Seizure disorders
  \item CMR_OBESE: Obesity
  \item CMR_PARALYSIS: Paralysis
  \item CMR_PERIVASC: Peripheral vascular disease
  \item CMR_PSYCHOSES: Psychoses
  \item CMR_PULMCIRC: Pulmonary circulation disorders
  \item CMR_RENLFL_MOD: Moderate renal failure
  \item CMR_RENLFL_SEV: Severe renal failure
  \item CMR_THYROID_HYPO: Hypothyroid disorders
  \item CMR_THYROID_OTH: Other thyroid disorders
  \item CMR_ULCER_PEPTIC: Peptic ulcer disease
  \item CMR_VALVE: Valvular disease
  \item CMR_WGHTLOSS: Weight loss
}
}
\examples{
\dontrun{
# Simple workflow - uses built-in lookup data automatically
result <- comorbidity(patient_data, 
                      dx_cols = c("dx2", "dx3", "dx4"),
                      poa_cols = c("poa2", "poa3", "poa4"))

# Calculate risk indices
result_with_indices <- cmr_index(result)

# Advanced workflow with custom lookup data
custom_comfmt <- build_comfmt_from_csv("path/to/custom_lookup.csv")
result <- comorbidity(patient_data, 
                      dx_cols = c("dx2", "dx3", "dx4"),
                      comfmt = custom_comfmt)
}
}
